import{j as e,a,a0 as t,a1 as n,r as s,d as r,x as o,G as l,u,ab as i,L as d,ae as c,M as p,R as f,af as m,F as b,v,y as _,aa as y,D as g,C as k,a6 as C,Q as h,ag as I,J as O,K as S}from"./vendor.4275dfb6.js";import{_ as x,a as w,b as j,L as U}from"./index.47159791.js";import{u as N}from"./useAddress.14e2a6b2.js";import{p as R}from"./goods.665b5313.js";const J=e=>(O("data-v-662b34c4"),e=e(),S(),e),V={class:"cart-goods-spec"},$={style:{"font-weight":"bolder"}},G={key:1,class:"van-multi-ellipsis--l2",style:{"font-weight":"bolder"}},L=J((()=>g("b",null,"配送",-1))),z=J((()=>g("div",null,"快递运输",-1))),D=J((()=>g("div",null,"工作日、双休日与节假日均可送货",-1))),H=J((()=>g("b",null,"留言",-1))),q=e({name:"GenerateOrder"});var A=x(Object.assign(q,{setup(e){const O=w(),S=j(),x=N();S.setHeaderStatus(!1);const J=a({tel:"",name:"",detail:""});t((()=>{!async function(){let e=S.getOrderInfo,a=null;try{e=JSON.parse(decodeURIComponent(e)),a=JSON.parse(sessionStorage.getItem("order-info-for-cart"))}catch{e=a=null}if(!e)return O.back();q.value=e.map((e=>({...e,unit_price:String(e.unit_price).includes(".")?e.unit_price:`${e.unit_price}.00`}))),a&&(A.pay_from=a.type||"",A.count=a.count||0)}(),async function(){const e=await x.query(),a=e.find((e=>e.isDefault))||(null==e?void 0:e[0]);if(!a)return;J.name=a.name,J.tel=a.tel,J.detail=a.address}()})),n((()=>{S.setHeaderStatus(!0),S.deleteOrderInfo(),sessionStorage.removeItem("order-info-for-cart")}));const q=s([]),A=a({pay_from:"",count:0}),F=r((()=>q.value.reduce(((e,a)=>e+(a.unit_price*a.count+Number(a.express_price))),0)||0)),K=r((()=>q.value.reduce(((e,a)=>e+Number(a.express_price)),0)||0));function M(){O.push(`/address?from=${encodeURIComponent("/address")}`)}function P(){O.push(`/address?from=${encodeURIComponent("/address")}`)}async function Q(){const e=await R({address:J,goods_list:q.value,total_pay_price:F.value,pay_from:A.pay_from});S.cartCount>0&&S.setCartCount(S.cartCount-A.count);const a=encodeURIComponent(JSON.stringify(e));O.replace({name:"PaymentCenter",params:{order_info:a}}),S.deleteOrderInfo()}return(e,a)=>(v(),o(b,null,[l(u(i),{title:"填写订单","safe-area-inset-top":"","left-arrow":"",onClickLeft:a[0]||(a[0]=e=>u(O).back())}),J.name&&J.tel?(v(),d(u(c),{key:1,type:"edit",tel:J.tel,name:J.name,onClick:P},null,8,["tel","name"])):(v(),d(u(c),{key:0,type:"add",onClick:M})),l(U,{background:"#f6f6f6"}),l(u(f),{inset:"",style:{margin:"0"}},{default:p((()=>[(v(!0),o(b,null,_(q.value,(e=>(v(),d(u(h),{key:e.id,border:!1,size:"large"},{default:p((()=>[l(u(y),{num:e.count,price:e.unit_price,title:e.title,thumb:e.image},{desc:p((()=>[g("div",V,[(v(!0),o(b,null,_(e.spec,((e,a)=>(v(),o("div",{key:a,class:"goods-spec-item"},["no-type"!==a?(v(),o(b,{key:0},[g("span",$,k(a)+"：",1),g("span",null,k(e),1)],64)):(v(),o("span",G,k(e),1))])))),128))])])),footer:p((()=>[l(u(C),{modelValue:e.count,"onUpdate:modelValue":a=>e.count=a,max:"99",theme:"round","button-size":"24"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["num","price","title","thumb"])])),_:2},1024)))),128)),l(u(h),{border:!1,"is-link":""},{title:p((()=>[L])),value:p((()=>[z,D])),_:1}),l(u(h),{botder:!1,center:""},{title:p((()=>[H])),value:p((()=>[l(u(I),{placeholder:"建议留言前先与商家沟通确认"})])),_:1}),l(U,{background:"#f6f6f6"}),l(u(h),{title:"运费",value:`￥${u(K)}`},null,8,["value"]),l(u(h),{botder:!1,title:"发票",value:"不开发票","is-link":""}),l(U,{background:"#f6f6f6"}),l(u(h),{botder:!1,title:"支付方式",value:"在线支付","is-link":""}),l(U,{background:"#f6f6f6"}),l(U,{space:"60px",background:"#f6f6f6"})])),_:1}),l(u(m),{price:100*u(F),"button-text":"提交订单",onSubmit:Q},null,8,["price"])],64))}}),[["__scopeId","data-v-662b34c4"],["__file","/home/runner/work/ecomv2_app/ecomv2_app/src/views/Cart/GenerateOrder.vue"]]);export{A as default};
