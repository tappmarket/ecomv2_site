import{j as e,a0 as a,a1 as s,d as t,r as l,w as u,x as o,G as n,u as i,ab as d,i as r,ac as v,M as c,S as f,F as p,n as m,v as h,ad as w}from"./vendor.4275dfb6.js";import{_ as b,u as y,a as g,b as D,d as j}from"./index.47159791.js";import{a as S}from"./goods.665b5313.js";import{u as $}from"./useAddress.14e2a6b2.js";const _=e({name:"ShippngAddr"});var x=b(Object.assign(_,{setup(e){const b=y(),_=g(),x=D(),k=$(),A=j(!1);x.setHeaderStatus(!1),a((()=>{C.value=k.query()})),s((()=>{x.setHeaderStatus(!0)}));const q=t({get(){var e;return(null==(e=C.value.find((e=>e.isDefault)))?void 0:e.id)||"1"},set:e=>e}),C=l([]),L=l();function O(){U.value=!0}function V(e){L.value=e.id,U.value=!0}function H(e){C.value=C.value.map((a=>(a.isDefault=!1,a.id===e.id&&(a.isDefault=!0),a))),k.addList(C.value),b.query.from&&_.back()}function M(){L.value="",B.value={}}const U=l(!1),B=l({}),E=({province:e,city:a,county:s,isDefault:t,name:l,id:u=null,tel:o,addressDetail:n})=>{const i={id:u||String(Math.random()).slice(2,13),name:l,tel:o,address:`${e}${a}${s}${n}`,isDefault:t};if(L.value){let e=C.value.find((e=>e.id===i.id));e=Object.assign(e,i),k.update(e.id,e)}else i.isDefault&&(C.value=C.value.map((e=>(e.isDefault=!1,e)))),C.value.push(i),k.addList(C.value);U.value=!1},F=()=>{U.value=!1,C.value=C.value.filter((e=>e.id!==L.value)),k.delete(L.value),U.value=!1},G=l([]);return u(U,(e=>{if(e){if(L.value){const{address:e,...a}=k.query(L.value)||{};return void async function(e){var a;await m(),A(!0);const s=await S();G.value=s;const t=function(e){const a=/([^省市区]+)/g,[s,t,l,u]=e.match(a);return{province:`${s}省`,city:`${t}市`,county:`${l}区`,addressDetail:u}}(e),l=Object.entries(s.county_list),u=null==(a=l.find((e=>(null==e?void 0:e[1])===t.county)))?void 0:a[0];return A(!1),{...t,areaCode:u}}(e).then((e=>{B.value={...a,...e}}))}S().then((e=>{G.value=e}))}})),(e,a)=>(h(),o(p,null,[n(i(d),{title:"收件地址","safe-area-inset-top":"","left-arrow":"",onClickLeft:a[0]||(a[0]=e=>i(_).back())}),n(i(v),{modelValue:i(q),"onUpdate:modelValue":a[1]||(a[1]=e=>r(q)?q.value=e:null),list:C.value,"default-tag-text":"默认",onAdd:O,onEdit:V,onSelect:H},null,8,["modelValue","list"]),n(i(f),{show:U.value,"onUpdate:show":a[2]||(a[2]=e=>U.value=e),round:"",closeable:"",position:"bottom",style:{height:"85%",paddingTop:"50px"},onClosed:M},{default:c((()=>[n(i(w),{"area-list":G.value,"address-info":B.value,"detail-rows":"2","show-delete":Boolean(L.value),"show-set-default":"","area-columns-placeholder":["请选择","请选择","请选择"],onSave:E,onDelete:F},null,8,["area-list","address-info","show-delete"])])),_:1},8,["show"])],64))}}),[["__file","/home/runner/work/ecomv2_app/ecomv2_app/src/views/Address/index.vue"]]);export{x as default};
